<!DOCTYPE html>
<html>
<head>
  <title>WFM Request Form</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f9f9f9;
      padding: 40px;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    .user-banner {
      text-align: center;
      margin-bottom: 20px;
      font-size: 14px;
      color: #555;
    }
    .logout-button {
      display: block;
      margin: 0 auto 30px auto;
      padding: 8px 16px;
      background-color: #ccc;
      color: #333;
      border: none;
      border-radius: 4px;
      font-size: 14px;
      cursor: pointer;
      text-align: center;
      text-decoration: none;
      width: fit-content;
    }
    form {
      max-width: 700px;
      margin: 0 auto;
      background-color: #fff;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin-top: 20px;
      font-weight: bold;
      color: #444;
    }
    input[type="text"],
    input[type="date"],
    input[type="number"],
    select,
    textarea {
      width: 100%;
      padding: 10px;
      margin-top: 6px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
      font-size: 14px;
    }
    input[type="file"] {
      margin-top: 10px;
    }
    textarea {
      resize: vertical;
      height: 100px;
    }
    button {
      margin-top: 30px;
      padding: 12px 20px;
      background-color: #0078D4;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      background-color: #005fa3;
    }
  </style>
</head>
<body>
  <h1>Submit WFM Request</h1>

  {% if session.user_email %}
    <div class="user-banner">
      Logged in as <strong>{{ session.user_email }}</strong>
    </div>
    <a href="/logout" class="logout-button">Logout</a>
  {% endif %}

  <form method="POST" enctype="multipart/form-data" onsubmit="return validateForm()">
    <label>Advisor Name:</label>
    <input type="text" name="advisor_name" required>

    <label>Date of Request:</label>
    <input type="date" name="request_date" required>

    <label>Line of Business (LoB):</label>
    <select name="lob" required>
      <option value="" disabled selected>Select LoB</option>
      <option value="ERO">ERO</option>
      <option value="IT">IT</option>
      <option value="MoveBuddy">MoveBuddy</option>
      <option value="PS Admin">PS Admin</option>
      <option value="PS BO">PS BO</option>
      <option value="PS Case Mgr">PS Case Mgr</option>
      <option value="PS CC">PS CC</option>
      <option value="PS Onboarding">PS Onboarding</option>
      <option value="PS Sales">PS Sales</option>
      <option value="QA">QA</option>
      <option value="SS Case Management">SS Case Management</option>
      <option value="SS Onboarding">SS Onboarding</option>
      <option value="SS Sales">SS Sales</option>
      <option value="TL/LoD">TL/LoD</option>
      <option value="Training">Training</option>
      <option value="WL PS">WL PS</option>
      <option value="WL SS">WL SS</option>
      <option value="Workforce Management">Workforce Management</option>
    </select>

    <label>Team Lead:</label>
    <select name="team_lead" required>
      <option value="" disabled selected>Select Team Lead</option>
      <option value="Adeyinka">Adeyinka</option>
      <option value="Alana">Alana</option>
      <option value="Alexandra">Alexandra</option>
      <option value="Aman">Aman</option>
      <option value="Bryan">Bryan</option>
      <option value="Cushana">Cushana</option>
      <option value="David">David</option>
      <option value="Dee">Dee</option>
      <option value="Jodi">Jodi</option>
      <option value="Julianne">Julianne</option>
      <option value="Kristin">Kristin</option>
      <option value="Lucas">Lucas</option>
      <option value="Maggie">Maggie</option>
      <option value="Mike">Mike</option>
      <option value="Odette">Odette</option>
      <option value="Pat">Pat</option>
      <option value="Salomon">Salomon</option>
      <option value="Sean">Sean</option>
      <option value="Shavindri">Shavindri</option>
      <option value="Teresa">Teresa</option>
    </select>

    <label>WFM Request Type:</label>
    <select name="wfm_request" id="wfm_request" onchange="toggleRequestFields()" required>
      <option value="" disabled selected>Select Request Type</option>
      <option value="Accommodation request/update">Accommodation request/update</option>
      <option value="Add additional hours">Add additional hours</option>
      <option value="Add/remove/change team meeting">Add/remove/change team meeting</option>
      <option value="Add/remove/move training">Add/remove/move training</option>
      <option value="Add offline segment">Add offline segment</option>
      <option value="Advisor arrived late, remove absence">Advisor arrived late, remove absence</option>
      <option value="CP skill update">CP skill update</option>
      <option value="Employee status update (not for schedule changes)">Employee status update (not for schedule changes)</option>
      <option value="Is OT available?">Is OT available?</option>
      <option value="Move break/lunch because of meeting">Move break/lunch because of meeting</option>
      <option value="Schedule Update - CP3 use">Schedule Update - CP3 use</option>
      <option value="Schedule Error Adjustment">Schedule Error Adjustment</option>
      <option value="Shift swap/offer">Shift swap/offer</option>
      <option value="Suggestions/Feedback">Suggestions/Feedback</option>
      <option value="Unpaid time off/vacation">Unpaid time off/vacation</option>
      <option value="Testing">Testing</option>
    </select>

<!-- Accommodation Section -->
<div id="AccommodationrequestupdateFields" style="display:none;">
  <label>Accommodation Action:</label>
  <div>
    <input type="radio" name="accommodation_action" value="Add"> Add
    <input type="radio" name="accommodation_action" value="Update"> Update
    <input type="radio" name="accommodation_action" value="Remove"> Remove
  </div>

  <label>Accommodation Type:</label>
  <select name="accommodation_type">
    <option value="" disabled selected>Select type</option>
    <option value="School">School</option>
    <option value="Personal">Personal</option>
    <option value="Medical">Medical</option>
  </select>

  <label>Final Date of Accommodation:</label>
  <input type="date" name="final_date">

  <label>Return to Work Date:</label>
  <input type="date" name="return_to_work_date">

  <label>Do you have CP3 Approval?</label>
  <div>
    <input type="radio" name="cp3_approval_status" value="Yes" onclick="toggleAccommodationCP3(true)"> Yes
    <input type="radio" name="cp3_approval_status" value="No" onclick="toggleAccommodationCP3(false)"> No
  </div>

  <div id="cp3Upload" style="display:none;">
    <label>Upload CP3 Approval Screenshot:</label>
    <input type="file" name="cp3_approval" accept=".pdf,.doc,.docx,.jpg,.png">
  </div>

  <label>Upload School Schedule (optional):</label>
  <input type="file" name="school_schedule" accept=".pdf,.doc,.docx,.xls,.xlsx,.jpg,.png">

  <label>Weekly Schedule:</label>
  <input type="text" name="monday_schedule" placeholder="Monday start/end (HH:MM AM/PM)">
  <input type="text" name="tuesday_schedule" placeholder="Tuesday start/end (HH:MM AM/PM)">
  <input type="text" name="wednesday_schedule" placeholder="Wednesday start/end (HH:MM AM/PM)">
  <input type="text" name="thursday_schedule" placeholder="Thursday start/end (HH:MM AM/PM)">
  <input type="text" name="friday_schedule" placeholder="Friday start/end (HH:MM AM/PM)">
  <input type="text" name="saturday_schedule" placeholder="Saturday start/end (HH:MM AM/PM)">
  <input type="text" name="sunday_schedule" placeholder="Sunday start/end (HH:MM AM/PM)">

  <label>Weekly Hours:</label>
  <input type="number" name="weekly_hours" min="0" placeholder="Enter number of hours">

  <label>Notes or Reason:</label>
  <textarea name="accommodation_notes" placeholder="Explain reason for this request."></textarea>
</div>

<!-- Add Additional Hours Section -->
<div id="AddadditionalhoursFields" style="display:none;">
  <label>How many days are we adding hours to?</label>
  <div>
    <input type="radio" name="additional_days" value="1 Day" onclick="toggleAdditionalHoursMode(false)"> 1 Day
    <input type="radio" name="additional_days" value="Multiple Days" onclick="toggleAdditionalHoursMode(true)"> Multiple Days
  </div>

  <div id="singleDayFields">
    <label>Requested Date:</label>
    <input type="date" name="additional_hours_date">
    <label>Start Time:</label>
    <input type="text" name="additional_start_time" placeholder="HH:MM AM/PM">
    <label>End Time:</label>
    <input type="text" name="additional_end_time" placeholder="HH:MM AM/PM">
  </div>

  <div id="multiDayFields" style="display:none;">
    <label>Weekly Schedule:</label>
    <input type="text" name="mon_start" placeholder="Monday start (HH:MM AM/PM)">
    <input type="text" name="mon_end" placeholder="Monday end (HH:MM AM/PM)">
    <input type="text" name="tue_start" placeholder="Tuesday start (HH:MM AM/PM)">
    <input type="text" name="tue_end" placeholder="Tuesday end (HH:MM AM/PM)">
    <input type="text" name="wed_start" placeholder="Wednesday start (HH:MM AM/PM)">
    <input type="text" name="wed_end" placeholder="Wednesday end (HH:MM AM/PM)">
    <input type="text" name="thu_start" placeholder="Thursday start (HH:MM AM/PM)">
    <input type="text" name="thu_end" placeholder="Thursday end (HH:MM AM/PM)">
    <input type="text" name="fri_start" placeholder="Friday start (HH:MM AM/PM)">
    <input type="text" name="fri_end" placeholder="Friday end (HH:MM AM/PM)">
    <input type="text" name="sat_start" placeholder="Saturday start (HH:MM AM/PM)">
    <input type="text" name="sat_end" placeholder="Saturday end (HH:MM AM/PM)">
    <input type="text" name="sun_start" placeholder="Sunday start (HH:MM AM/PM)">
    <input type="text" name="sun_end" placeholder="Sunday end (HH:MM AM/PM)">
  </div>

  <label>Weekly Hours:</label>
  <input type="number" name="additional_weekly_hours" min="0" placeholder="Enter number of hours">

  <label>Notes or Reason:</label>
  <textarea name="additional_hours_notes" placeholder="Explain reason for adding hours."></textarea>
</div>

<!-- Add/Remove/Change Team Meeting Section -->
<div id="AddremovechangeteammeetingFields" style="display:none;">
  <label>Meeting Action:</label>
  <div>
    <input type="radio" name="team_meeting_action" value="Add"> Add
    <input type="radio" name="team_meeting_action" value="Remove"> Remove
    <input type="radio" name="team_meeting_action" value="Change"> Change
  </div>

  <label>Meeting Date:</label>
  <input type="date" name="team_meeting_date">
  <label>Start Time:</label>
  <input type="text" name="team_meeting_start" placeholder="HH:MM AM/PM">
  <label>End Time:</label>
  <input type="text" name="team_meeting_end" placeholder="HH:MM AM/PM">
  <label>Notes or Reason:</label>
  <textarea name="team_meeting_notes" placeholder="Explain reason for meeting request."></textarea>
</div>

<!-- Add/Remove/Move Training Section -->
<div id="AddremovemovetrainingFields" style="display:none;">
  <label>Training Action:</label>
  <div>
    <input type="radio" name="training_action" value="Add"> Add
    <input type="radio" name="training_action" value="Remove"> Remove
    <input type="radio" name="training_action" value="Move"> Move
  </div>

  <label>Training Date:</label>
  <input type="date" name="training_date">
  <label>Start Time:</label>
  <input type="text" name="training_start" placeholder="HH:MM AM/PM">
  <label>End Time:</label>
  <input type="text" name="training_end" placeholder="HH:MM AM/PM">
  <label>Notes or Reason:</label>
  <textarea name="training_notes" placeholder="Explain reason for training request."></textarea>
</div>

<!-- Add Offline Segment Section -->
<div id="AddofflinesegmentFields" style="display:none;">
  <label>Offline Segment Date:</label>
  <input type="date" name="offline_segment_date">
  <label>Start Time:</label>
  <input type="text" name="offline_segment_start" placeholder="HH:MM AM/PM">
  <label>End Time:</label>
  <input type="text" name="offline_segment_end" placeholder="HH:MM AM/PM">
  <label>Which segment is being updated?</label>
  <select name="offline_segment_type">
    <option value="" disabled selected>Select segment</option>
    <option>After Shift</option>
    <option>Client Account Work</option>
    <option>Coaching</option>
    <option>Code of Conduct</option>
    <option>Knowledge Assessment</option>
    <option>Meeting</option>
    <option>Personal</option>
    <option>Store Visit</option>
    <option>System Issue</option>
    <option>System Outage</option>
    <option>Training</option>
  </select>
  <label>Notes or Reason:</label>
  <textarea name="offline_segment_notes" placeholder="Explain reason for this offline segment request."></textarea>
</div>

<!-- Advisor Arrived Late Section -->
<div id="AdvisorarrivedlateremoveabsenceFields" style="display:none;">
  <label>Actual Start Time:</label>
  <input type="text" name="actual_start_time" placeholder="HH:MM AM/PM">
  <label>Actual Arrival Time:</label>
  <input type="text" name="actual_arrival_time" placeholder="HH:MM AM/PM">
  <label>Notes or Reason:</label>
  <textarea name="late_arrival_notes" placeholder="Explain reason for removing the absence."></textarea>
</div>

<!-- CP Skill Update -->
<div id="CPskillupdateFields" style="display:none;">
  <!-- Remove Section -->
  <label>Skill(s) to Remove – English:</label>
  <select name="skill_remove_en">
    <option value="">-- Select English Skill to Remove --</option>
    <option>MoveBuddy</option>
    <option>PS CC EN</option>
    <option>PS Sales EN</option>
    <option>PS WL EN</option>
    <option>SS CM EN</option>
    <option>SS Sales EN</option>
    <option>SS WL EN</option>
    <option>PS Test</option>
    <option>SS Test</option>
  </select>

  <label>Skill(s) to Remove – French:</label>
  <select name="skill_remove_fr">
    <option value="">-- Select French Skill to Remove --</option>
    <option>PS CC FR</option>
    <option>PS Sales FR</option>
    <option>PS WL FR</option>
    <option>SS CM FR</option>
    <option>SS Sales FR</option>
    <option>SS WL FR</option>
  </select>

  <!-- Add Section -->
  <label>Skill(s) to Add – English:</label>
  <select name="skill_add_en">
    <option value="">-- Select English Skill to Add --</option>
    <option>MoveBuddy</option>
    <option>PS CC EN</option>
    <option>PS Sales EN</option>
    <option>PS WL EN</option>
    <option>SS CM EN</option>
    <option>SS Sales EN</option>
    <option>SS WL EN</option>
    <option>PS Test</option>
    <option>SS Test</option>
  </select>

  <label>Skill(s) to Add – French:</label>
  <select name="skill_add_fr">
    <option value="">-- Select French Skill to Add --</option>
    <option>PS CC FR</option>
    <option>PS Sales FR</option>
    <option>PS WL FR</option>
    <option>SS CM FR</option>
    <option>SS Sales FR</option>
    <option>SS WL FR</option>
  </select>

  <!-- Notes -->
  <label>Notes or Reason:</label>
  <textarea name="cp_skill_notes" placeholder="Explain reason for skill update."></textarea>
</div>

<!-- Submit -->
<button type="submit">Submit</button>
</form>

<script>
function toggleRequestFields() {
  const selected = document.getElementById("wfm_request").value;
  const allTypes = [
    "Accommodation request/update","Add additional hours","Add/remove/change team meeting",
    "Add/remove/move training","Add offline segment","Advisor arrived late, remove absence",
    "CP skill update","Employee status update (not for schedule changes)","Is OT available?",
    "Move break/lunch because of meeting","Schedule Update - CP3 use","Schedule Error Adjustment",
    "Shift swap/offer","Suggestions/Feedback","Unpaid time off/vacation","Testing"
  ];
  allTypes.forEach(type=>{
    const id = type.replace(/[\s\/(),]/g,'')+"Fields";
    const section=document.getElementById(id);
    if(section){section.style.display=(type===selected)?"block":"none";}
  });
}
function toggleAccommodationCP3(show){
  const el=document.getElementById("cp3Upload");
  if(el)el.style.display=show?"block":"none";
}
function toggleAdditionalHoursMode(multi){
  document.getElementById("singleDayFields").style.display=multi?"none":"block";
  document.getElementById("multiDayFields").style.display=multi?"block":"none";
}
function validateForm(){
  const req=document.getElementById("wfm_request").value;
  if(req==="Add/remove/change team meeting"){
    const a=document.querySelector('input[name="team_meeting_action"]:checked');
    const d=document.querySelector('input[name="team_meeting_date"]');
    const s=document.querySelector('input[name="team_meeting_start"]');
    const e=document.querySelector('input[name="team_meeting_end"]');
    const n=document.querySelector('textarea[name="team_meeting_notes"]');
    if(!a||!d.value||!s.value||!e.value){alert("Please complete all required fields for the team meeting.");return false;}
    if(!n.value.trim()){alert("Please provide notes or a reason for the team meeting request.");return false;}
  }
  if(req==="Add/remove/move training"){
    const a=document.querySelector('input[name="training_action"]:checked');
    const d=document.querySelector('input[name="training_date"]');
    const s=document.querySelector('input[name="training_start"]');
    const e=document.querySelector('input[name="training_end"]');
    const n=document.querySelector('textarea[name="training_notes"]');
    if(!a||!d.value||!s.value||!e.value){alert("Please complete all required fields for the training request.");return false;}
    if(!n.value.trim()){alert("Please provide notes or a reason for the training request.");return false;}
  }
  if(req==="Advisor arrived late, remove absence"){
    const s=document.querySelector('input[name="actual_start_time"]');
    const a=document.querySelector('input[name="actual_arrival_time"]');
    const n=document.querySelector('textarea[name="late_arrival_notes"]');
    if(!s.value||!a.value){alert("Please fill both Actual Start and Arrival times.");return false;}
    if(!n.value.trim()){alert("Please provide notes for the late arrival.");return false;}
  }
  if(req==="CP skill update"){
    const add=document.querySelector('select[name="skill_add"]');
    const rem=document.querySelector('select[name="skill_remove"]');
    const n=document.querySelector('textarea[name="cp_skill_notes"]');
    if((!add.value&&!rem.value)||!n.value.trim()){alert("Select at least one skill to add or remove and provide notes.");return false;}
  }
  return true;
}
</script>
</body>
</html>

